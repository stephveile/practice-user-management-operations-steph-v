drop table if exists customers;
drop table if exists orders;

create table customers (
 id int primary key auto_increment,
 first_name varchar(50),
 last_name varchar(50)
);

create table orders (
 id int primary key,
 customer_id int null,
 order_date date,
 total_amount decimal(10, 2),
 foreign key (customer_id) references customers(id)
);

insert into customers (id, first_name, last_name) values
(1, 'John', 'Doe'),
(2, 'Jane', 'Smith'),
(3, 'Alice', 'Smith'),
(4, 'Bob', 'Brown');

insert into orders (id, customer_id, order_date, total_amount) values
(1, 1, '2023-01-01', 100.00),
(2, 1, '2023-02-01', 150.00),
(3, 2, '2023-01-01', 200.00),
(4, 3, '2023-04-01', 250.00),
(5, 3, '2023-04-01', 300.00),
(6, NULL, '2023-04-01', 100.00);

select customer_id, sum(total_amount) as total_spent from orders group by customer_id;

select customer_id, order_date, sum(total_amount) as total_spent from orders group by customer_id, order_date;

select customer_id, sum(total_amount) as total_spent from orders where total_amount >= 200 group by customer_id;

select customer_id, sum(total_amount) as total_spent from orders group by customer_id having sum(total_amount) > 200;

select * from orders;

select orders.id, customers.first_name, customers.last_name, orders.order_date, orders.total_amount from orders inner join customers on orders.customer_id = customers.id;

select orders.id, customers.first_name, customers.last_name, orders.order_date, orders.total_amount from orders left join customers on orders.customer_id = customers.id;

select id, order_date, total_amount from orders where total_amount >= (select avg(total_amount) from orders);

select id, order_date, total_amount, customer_id from orders where customer_id in (select id from customers where last_name = 'Smith');

select order_date from (select id, order_date, total_amount from orders) as order_summary;
